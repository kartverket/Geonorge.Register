function showLoadingAnimation(e){$("#loading-animation").html(e),$("#loading-animation").show()}function hideLoadingAnimation(){$("#loading-animation").html(""),$("#loading-animation").hide()}function notOpeningInNewTab(e){return!(e.ctrlKey||e.shiftKey||e.metaKey||e.button&&1==e.button)}function addDefaultLoadingAnimation(e){e.addClass("show-loading-animation"),e.data("loading-message","Henter innhold")}function updateShoppingCart(){var e=$("#orderitem-count"),t="",a={},o="orderitems",n=0,i=".geonorge.no";null!==localStorage.getItem("orderItems")&&"[]"!=localStorage.getItem("orderItems")&&(t=localStorage.getItem("orderItems")),""!==t?(e.css("display","block"),a=JSON.parse(t),n=a.length,e.html(n)):void 0!==Cookies.get(o)&&0!==Cookies.get(o)&&"0"!==Cookies.get(o)?(n=Cookies.get(o),e.css("display","block"),e.html(n)):e.css("display","none"),Cookies.set(o,n,{expires:7,path:"/",domain:i})}function updateShoppingCartCookie(){var e=$("#orderitem-count"),t="orderitems",a=".geonorge.no",o=0;if(null!==localStorage.getItem("orderItems")&&"[]"!=localStorage.getItem("orderItems")){var n=localStorage.getItem("orderItems"),i=JSON.parse(n);o=i.length,e.html(o)}else o=0,e.css("display","none");Cookies.set(t,o,{expires:7,path:"/",domain:a})}function updateToggleLinks(e){$(e).each(function(){$(this).toggleClass("show-content")})}function activateTab(e){$(".link-tabs").ready(function(){tabLink=$(".link-tabs li a[data-tab='"+e+"']"),$(".link-tabs li.active").removeClass("active"),tabLink.parent("li").addClass("active")})}function updateAllCartButtons(e){$(".add-to-cart-btn").each(function(){var t=$(this).attr("itemuuid");$.inArray(t,e)>-1&&($(this).addClass("disabled"),$(this).attr("title","Allerede lagt til i kurv"),$(this).children(".button-text").text(" Lagt i kurv"))})}function updateCartButton(e){var t=$(e).attr("itemuuid");$('.add-to-cart-btn[itemuuid="'+t+'"]').each(function(){$(this).addClass("disabled"),$(this).attr("data-original-title","Allerede lagt til i kurv"),$(this).children(".button-text").text(" Lagt i kurv")})}var applicationEnvironment=void 0===applicationEnvironment?"":applicationEnvironment,applicationVersionNumber=void 0===applicationVersionNumber?"":applicationVersionNumber,supportsLogin=!1,authenticationData=void 0===authenticationData?{}:authenticationData;authenticationData!=={}&&(supportsLogin=void 0!==authenticationData.supportsLogin&&authenticationData.supportsLogin,authenticationData.isAuthenticated=void 0!==authenticationData.isAuthenticated&&authenticationData.isAuthenticated,authenticationData.urlActionSignIn=void 0===authenticationData.urlActionSignIn?"":authenticationData.urlActionSignIn,authenticationData.urlActionSignOut=void 0===authenticationData.urlActionSignOut?"":authenticationData.urlActionSignOut,authenticationData.userName=void 0===authenticationData.userName?"":authenticationData.userName);var geonorgeUrl=""===applicationEnvironment?"https://www.geonorge.no/":"https://www.test.geonorge.no/";showLoadingAnimation("Laster innhold"),$(document).ready(function(){hideLoadingAnimation(),$(document).on("click",".show-loading-animation",function(e){if(notOpeningInNewTab(e)){var t=void 0!==$(this).data("loading-message")?$(this).data("loading-message"):"";showLoadingAnimation(t)}}),$("#geonorge-logo").length&&($("#geonorge-logo a").prop("href",geonorgeUrl),$("#geonorge-logo a img").prop("src","/Content/bower_components/kartverket-felleskomponenter/assets/images/svg/geonorge_"+applicationEnvironment+"logo.svg")),$("#applicationVersionNumber").length&&""!==applicationVersionNumber&&$("#applicationVersionNumber").html("Versjon "+applicationVersionNumber);var e="https://kartkatalog.geonorge.no/Download";""!==applicationEnvironment&&(e="https://kartkatalog."+applicationEnvironment+".geonorge.no/Download"),$("#shopping-car-url").prop("href",e),supportsLogin&&$("#container-login").length&&($("#container-login").append("<ul></ul>"),$("#container-login ul").append("<li><a href='"+geonorgeUrl+"kartdata/oppslagsverk/Brukernavn-og-passord/'>Ny bruker</a></li>"),authenticationData.isAuthenticated?$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignOut+"' class='geonorge-aut' title='Logg ut "+authenticationData.userName+"'> Logg ut</a></li>"):$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignIn+"' class='geonorge-aut'> Logg inn</a></li>"))}),$(window).load(function(){var e={disable_search_threshold:10,search_contains:!0};$(".chosen-select").chosen(e),$("[data-toggle='tooltip']").tooltip(),$("li.has-error[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+30"}),$("li[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()}),$(".ui-tooltip-element[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+25"}),$(".ui-tooltip-element[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()});var t=document.documentElement;t.setAttribute("data-useragent",navigator.userAgent)}),angular.module("geonorge",["ui.bootstrap"]),angular.module("geonorge").config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["**"])}]);var searchOptionsArray={dev:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.dev.geonorge.no",url:"//kartkatalog.dev.geonorge.no/search",api:"//kartkatalog.dev.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},test:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.test.geonorge.no",url:"//kartkatalog.test.geonorge.no/search",api:"//kartkatalog.test.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},prod:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.geonorge.no",url:"//kartkatalog.geonorge.no/search",api:"//kartkatalog.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.geonorge.no"}},searchOption=searchOptionsArray.prod;if(""!==applicationEnvironment&&null!==applicationEnvironment)var searchOption=searchOptionsArray[applicationEnvironment];var baseurl_local=searchOption.baseUrl;!function(){var e=angular.module("geonorge");e.service("aggregatedService",["$http","$q",function(e,t){function a(e){l=e}function o(e){return t(function(t){void 0===l?t():l(e)})}function n(a,o,n,i){function r(e,t){var a="facets[1]name=type&facets[1]value="+e,o="text="+t;return"?limit=5&"+a+"&"+o}var l=encodeURI(searchOption.api+"?limit=5&facets[1]name=type&facets[1]value=dataset&text="+a),s=e({method:"GET",url:l,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),c=encodeURI(searchOption.api+r("servicelayer",a)),u=e({method:"GET",url:c,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),g=encodeURI(searchOption.api+r("service",a)),d=e({method:"GET",url:g,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),p=encodeURI(searchOption.api+r("dimensionGroup",a)),h=e({method:"GET",url:p,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}});return t.all([h,s,d,u])}var i=document.getElementById("txtLang"),r="";i&&(r=i.value);var l=void 0;return{triggerSearch:o,executeMethod:a,performSearch:n}}]).controller("searchTopController",["$rootScope","$scope","$location","$window","$timeout","aggregatedService","$sce",function(e,t,a,o,n,i,r){function l(){var a=t.selectedSearch,n="";""!==e.searchQuery&&(n=a.queryParameter,n+=e.searchQuery);var i=a.url+n;o.location.href=i}function s(e){if(t.ajaxCallActive=!1,t.autoCompleteResult=[],e.d){var a=[];if(0===e.d.NumberOfHitsTotal)return void(t.autoCompleteResult=[]);a=e.d.Results;for(var o=0;o<a.length;o++){var n={},i=a[o];if(0!==i.data.Results.length){n.type=i.Section,n.title=i.SectionName,n.list=[];for(var r=0;r<i.data.Results.length;r++){var l=i.data.Results[r];n.title=c(l.Type),n.url=searchOption.url,n.list.push({externalId:i.SectionName+"_"+i.Section+"_"+r,id:r,typeId:i.Section,title:l.Title,url:l.ShowDetailsUrl})}t.autoCompleteResult.push(n),console.log(n)}}}}function c(e){switch(e){case"dataset":return"Datasett";case"servicelayer":return"Tjenestelag";case"service":return"Tjenester";case"dimensionGroup":return"Datapakker"}}function u(){k>0&&1==f&&(k--,0===k&&(f=null)),1==k&&f>1&&(f--,k=t.autoCompleteResult[f-1].list.length),f>1&k>1&&k--,d()}function g(){null===f?(f=1,k=1):(f==t.autoCompleteResult.length&&t.autoCompleteResult[f-1].list.length>k&&k++,f<t.autoCompleteResult.length&&(t.autoCompleteResult[f-1].list.length>k?k++:(f++,k=1))),d()}function d(){for(var e=0;e<t.autoCompleteResult.length;e++){var a=t.autoCompleteResult[e];if(e==f-1)for(var o=0;o<a.list.length;o++){var n=a.list[o];o==k-1?n.highlight=!0:n.highlight=!1}else for(var i=0;i<a.list.length;i++)a.list[i].highlight=!1}console.log("categoryCount "+f),console.log("resultCount "+k)}e.trustHtml=function(e){return r.trustAsHtml(e)},t.dropdownOpen=!1,t.extendedSearchOpen=!1,t.showFakeResults=!1,t.searchString="",e.selectedSearch=searchOption,e.searchQuery=parseLocation(window.location.search).text,t.autoCompleteResult=[],t.autoCompletePartial="/Content/bower_components/kartverket-felleskomponenter/assets/partials/_autoCompleteRow.html",t.focused=!1,t.autocompleteActive=!1,t.ajaxCallActive=!1,t.allowBlur=!0,t.viewport={width:window.innerWidth,height:window.innerHeight},t.breakpoints={xSmall:480,small:768,medium:992,large:1200};var p=function(a,o){a.preventDefault(),a.stopPropagation(),e.selectedSearch=o,t.dropdownOpen=!1;var n=document.getElementById("txtSearch");n.focus()};t.select=p;var h=function(e){var t;switch(e.keyCode){case 38:e.target.blur(),t=angular.element(e.target).next(),t.children()[dropdownOptions.length-1].focus();break;case 40:e.target.blur(),t=angular.element(e.target).next(),t.children()[0].focus();break;default:return}e.preventDefault(),e.stopPropagation()},m=function(e,t){var a;switch(e.keyCode){case 13:return void p(e,dropdownOptions[t]);case 38:var o=angular.element(document.getElementById("search-dropdown"));a=0===t?o.children()[dropdownOptions.length-1]:o.children()[t-1];break;case 40:a=t>=dropdownOptions.length-1?angular.element(document.getElementById("search-dropdown")).children()[0]:angular.element(e.target).next()[0];break;default:return}e.target.blur(),a.focus(),e.preventDefault(),e.stopPropagation()};t.dropdownKeyDown=m,t.buttonDropdownKeyDown=h,t.onSearch=function(t){if(t&&t.preventDefault(),!(e.searchQuery.length<3)){var a=i.triggerSearch(e.searchQuery);a.then(l)}},t.preventDefault=function(e){switch(e.keyCode){case 13:e.preventDefault();break;case 16:$=!0;break;case 9:t.autoCompleteResult.length>0&&e.preventDefault();break;case 38:case 40:e.preventDefault()}};var v=null;t.autocomplete=function(a){if(t.focused!==!1){if(e.searchQuery.length<3)return t.autoCompleteResult=[],t.autocompleteActive=!1,t.ajaxCallActive=!1,void(f=null);switch(a.keyCode){case 13:null===f?(t.resetAutocomplete(),t.allowBlur=!0,t.onSearch(a)):(t.allowBlur=!1,window.location=t.autoCompleteResult[f-1].list[k-1].url);break;case 16:$=!1;break;case 37:break;case 38:return u(),!1;case 39:break;case 9:$?u():g();break;case 40:return g(),!1;default:return f=null,v&&(n.cancel(v),v=null,console.log("cancel timeout")),void(v=n(function(){t.autocompleteActive=!0,console.log("calling WS"),e.searchQuery.length>0&&(t.ajaxCallActive=!0,i.performSearch(e.searchQuery,[],5,0).then(function(e){console.log(e);var t={d:{Results:e}};s(t)}))},300))}}};var f=null,k=null,$=!1;t.mouseOver=function(e,a,o){console.log(a),console.log(o),t.allowBlur=e,k=o+1,f=a+1,d()},t.mouseOut=function(e){t.allowBlur=e},t.resetAutocomplete=function(){t.focused=!1,t.autocompleteActive=!1,t.ajaxCallActive=!1,t.autoCompleteResult=[]},t.setFocus=function(e){t.focused=!0,console.log(t.focused),angular.element(e.target).on("blur",function(){n(function(){t.allowBlur&&(t.resetAutocomplete(),console.log(t.focused),angular.element(e.target).on("blur",null))},!0)})},angular.element(document).ready(function(){i.triggerSearch(e.searchQuery)})}])}();var parseLocation=function(e){var t,a,o=e.substring(1).split("&"),n={};for(a in o)""!==o[a]&&(t=o[a].split("="),n[decodeURIComponent(t[0])]=decodeURIComponent(t[1]));return n},baseurl="http://"+window.location.host;$(document).ready(function(){$(".page-wizard .page-wizard-tab").on("click",function(){$(".page-wizard").toggleClass("open")});var e=$("<li class='jose'><ul></ul></li>");$("<p>te</p>").appendTo($(e).find("ul"))}),function(){var e=angular.module("geonorge"),t=searchOption.geonorgeUrl;e.controller("menuTopController",["$scope","$http",function(e,a){function o(t){localStorage.setItem("menuItems",JSON.stringify(t));var a=new Date,o=3;a.setTime(a.getTime()+60*o*1e3),Cookies.set("expire","menu",{expires:a}),e.menuItems=t.data}function n(){e.getMenuError=!0}e.getMenuData=function(){if(!Cookies.get("expire")||!localStorage.getItem("menuItems")){var i=t+"/api/menu",r=a({method:"GET",url:i,headers:{"Content-Type":"application/json; charset=utf-8"},data:{}});return console.log("Menu loaded from server"),r.then(o,n)}console.log("Menu loaded locally"),response=JSON.parse(localStorage.getItem("menuItems")),e.menuItems=response.data}}])}(),$(window).load(function(){updateShoppingCart()}),$("document").ready(function(){updateToggleLinks($(".toggle-content")),$(".toggle-content").click(function(){var e=$(this).data("content-toggle");updateToggleLinks($(this)),$("."+e).toggle()})}),$(".link-tabs").ready(function(){$(".link-tabs li a").click(function(e){e.preventDefault(),activateTab($(this).data("tab")),$("#tab-content").css("opacity",".15"),window.location.href=$(this).prop("href")})}),$("document").ready(function(){$("a.help-text-toggle").click(function(e){e.preventDefault();var t=$(this),a=$(this).data("help-text-id");$("#"+a).toggle(),$("#"+a).hasClass("active")?($("#"+a).removeClass("active"),t.removeClass("active")):($("#"+a).addClass("active"),t.addClass("active"))})}),$("document").ready(function(){$("ul.pagination a").each(function(){$(this).closest("li").hasClass("active")||addDefaultLoadingAnimation($(this))})});