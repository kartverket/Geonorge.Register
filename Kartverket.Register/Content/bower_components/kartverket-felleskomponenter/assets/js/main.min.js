function containsParameters(e){return!!(e.length&&e.indexOf("?")>-1)}function urlContainsParameters(){return containsParameters(window.location.search)}function showLoadingAnimation(e){$("#loading-animation").html(e),$("#loading-animation").show()}function hideLoadingAnimation(){$("#loading-animation").html(""),$("#loading-animation").hide()}function notOpeningInNewTab(e){return!(e.ctrlKey||e.shiftKey||e.metaKey||e.button&&1==e.button)}function addDefaultLoadingAnimation(e){e.addClass("show-loading-animation"),e.data("loading-message","Henter innhold")}function setMainSearchUrl(e,t){environmentIsSet=!1;var a="";void 0!==t&&("dev"==t||"test"==t||"prod"==t?(environmentIsSet=!0,a="prod"==t?"":"."+t):console.error("incorrect value for environment. Use 'dev', 'test' or 'prod'")),environmentIsSet?searchOptionsArray[t].url="//kartkatalog"+a+".geonorge.no/"+e:(searchOptionsArray.dev.url="//kartkatalog.dev.geonorge.no/"+e,searchOptionsArray.test.url="//kartkatalog.test.geonorge.no/"+e,searchOptionsArray.prod.url="//kartkatalog.geonorge.no/"+e)}function setMainSearchApiUrl(e,t){environmentIsSet=!1;var a="";void 0!==t&&("dev"==t||"test"==t||"prod"==t?(environmentIsSet=!0,a="prod"==t?"":"."+t):console.error("incorrect value for environment. Use 'dev', 'test' or 'prod'")),environmentIsSet?searchOptionsArray[t].api="//kartkatalog"+a+".geonorge.no/api/"+e:(searchOptionsArray.dev.api="//kartkatalog.dev.geonorge.no/api/"+e,searchOptionsArray.test.api="//kartkatalog.test.geonorge.no/api/"+e,searchOptionsArray.prod.api="//kartkatalog.geonorge.no/api/"+e)}function setMainSearchPlaceholder(e,t){environmentIsSet=!1;void 0!==t&&("dev"==t||"test"==t||"prod"==t?environmentIsSet=!0:console.error("incorrect value for environment. Use 'dev', 'test' or 'prod'")),environmentIsSet?searchOptionsArray[t].searchPlaceholder=e:(searchOptionsArray.dev.searchPlaceholder=e,searchOptionsArray.test.searchPlaceholder=e,searchOptionsArray.prod.searchPlaceholder=e)}function addShoppingCartTooltip(e){var t=$("#shopping-cart-url"),a=0!==e?e:"ingen",o=1==e?"Du har "+a+" nedlasting i kurven din":"Du har "+a+" nedlastinger i kurven din";t.attr("title",o),t.attr("data-original-title",o),t.data("toggle","tooltip"),t.data("placement","bottom"),t.tooltip()}function removeSingleItemFromArray(e,t){var a=e.indexOf(t);return a>=0&&e.splice(a,1),e}function removeFromArray(e,t){Array.isArray(t)?t.forEach(function(t){e=removeSingleItemFromArray(e,t)}):e=removeSingleItemFromArray(e,t)}function removeBrokenOrderItems(){var e=JSON.parse(localStorage.getItem("orderItems"));null!==e&&(removeFromArray(e,[null,void 0,"null",{},""]),localStorage.setItem("orderItems",JSON.stringify(e)))}function updateShoppingCart(){var e=$("#orderitem-count"),t="",a=0;null!==localStorage.getItem("orderItems")&&(t=localStorage.getItem("orderItems")),""!==t?(a=JSON.parse(t).length)>0?(e.css("display","block"),e.html(a),addShoppingCartTooltip(a)):(e.css("display","none"),addShoppingCartTooltip(0)):void 0!==Cookies.get("orderitems")&&0!==Cookies.get("orderitems")&&"0"!==Cookies.get("orderitems")?(a=Cookies.get("orderitems"),e.css("display","block"),e.html(a),addShoppingCartTooltip(a)):(e.css("display","none"),addShoppingCartTooltip(0)),Cookies.set("orderitems",a,{expires:7,path:"/",domain:".geonorge.no"})}function updateShoppingCartCookie(){var e=$("#orderitem-count"),t=0;if(null!==localStorage.getItem("orderItems")&&"[]"!=localStorage.getItem("orderItems")){var a=localStorage.getItem("orderItems");t=JSON.parse(a).length,e.html(t),addShoppingCartTooltip(t)}else t=0,e.css("display","none"),addShoppingCartTooltip(t);Cookies.set("orderitems",t,{expires:7,path:"/",domain:".geonorge.no"})}function updateToggleLinks(e){$(e).each(function(){$(this).toggleClass("show-content")})}function activateTab(e){$(".link-tabs").ready(function(){tabLink=$(".link-tabs li a[data-tab='"+e+"']"),$(".link-tabs li.active").removeClass("active"),tabLink.parent("li").addClass("active")})}function updateAllCartButtons(e){$(".add-to-cart-btn").each(function(){var t=$(this).attr("itemuuid");$.inArray(t,e)>-1&&($(this).addClass("added"),$(this).attr("title","Allerede lagt til i kurv"),$(this).children(".button-text").text(" Lagt i kurv"))})}function updateCartButton(e,t){var a=$(e).attr("itemuuid");$.inArray(a,t)>-1?$('.add-to-cart-btn[itemuuid="'+a+'"]').each(function(){var e=void 0!==$(this).attr("itemname")?" "+$(this).attr("itemname")+" ":"";$(this).addClass("added"),$(this).attr("data-original-title","Fjern"+e+"fra kurv"),$(this).children(".button-text").text(" Fjern fra kurv")}):$('.add-to-cart-btn[itemuuid="'+a+'"]').each(function(){var e=void 0!==$(this).attr("itemname")?" "+$(this).attr("itemname")+" ":"";$(this).removeClass("added"),$(this).attr("data-original-title","Legg til"+e+"i kurv"),$(this).children(".button-text").text(" Legg i kurv")})}function notCurrentUrl(e){return e==window.location.href||e==window.location.pathname||(e==window.location.href+"/"||e==window.location.pathname+"/"||void 0)}function disableLastBreadcrumb(){if($("ul.breadcrumbs li").last().has("a").length){var e=$("ul.breadcrumbs li").last().text();$("ul.breadcrumbs li").last().html(e)}}function showAlert(e,t){$("#feedback-alert").attr("class","alert alert-dismissible alert-"+t),$("#feedback-alert .message").html($("#feedback-alert .message").html()+e+"<br/>"),$("#feedback-alert").show()}function clearAlertMessage(){$("#feedback-alert .message").html("")}function hideAlert(){$("#feedback-alert").hide()}function getParameterByName(e){var t=location.search.toLowerCase();e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function removeParameterByName(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+e+"([^&#]*)").exec(t);return t=t.replace(a[0],"")}function removeParameterByNameFromUrl(e){var t=location.search.toLowerCase();t=removeParameterByName(e,t);var a=location.pathname+t;window.history.replaceState({path:a},null,a)}function filterDropdownList(e,t){for(var a=t.find(".custom-select-list-options"),o=e.val().toUpperCase(),n=0;n<a.length;n++){for(var r=a[n].getElementsByTagName("li"),i=!1,l=0;l<r.length;l++)r[l].innerHTML.toUpperCase().indexOf(o)>-1?(r[l].style.display="",i=!0):r[l].style.display="none";var s=$(a[n]).closest("div").find(".custom-select-list-option-group-name");i?s.show():s.hide()}}var applicationEnvironment=void 0===applicationEnvironment?"":applicationEnvironment,applicationVersionNumber=void 0===applicationVersionNumber?"":applicationVersionNumber,supportsLogin=!1,authenticationData=void 0===authenticationData?{}:authenticationData;authenticationData!=={}&&(supportsLogin=void 0!==authenticationData.supportsLogin&&authenticationData.supportsLogin,authenticationData.isAuthenticated=void 0!==authenticationData.isAuthenticated&&authenticationData.isAuthenticated,authenticationData.urlActionSignIn=void 0===authenticationData.urlActionSignIn?"":authenticationData.urlActionSignIn,authenticationData.urlActionSignOut=void 0===authenticationData.urlActionSignOut?"":authenticationData.urlActionSignOut,authenticationData.userName=void 0===authenticationData.userName?"":authenticationData.userName);var geonorgeUrl=""===applicationEnvironment?"https://www.geonorge.no/":"https://www.test.geonorge.no/";showLoadingAnimation("Laster innhold"),$(document).ready(function(){hideLoadingAnimation(),$(document).on("click",".show-loading-animation",function(e){notOpeningInNewTab(e)&&showLoadingAnimation(void 0!==$(this).data("loading-message")?$(this).data("loading-message"):"")}),$("#geonorge-logo").length&&($("#geonorge-logo a").prop("href",geonorgeUrl),$("#geonorge-logo a img").prop("src","/Content/bower_components/kartverket-felleskomponenter/assets/images/svg/geonorge_"+applicationEnvironment+"logo.svg")),$("#applicationVersionNumber").length&&""!==applicationVersionNumber&&$("#applicationVersionNumber").html("Versjon "+applicationVersionNumber);var e="https://kartkatalog.geonorge.no/nedlasting";""!==applicationEnvironment&&(e="https://kartkatalog."+applicationEnvironment+".geonorge.no/nedlasting"),$("#shopping-cart-url").prop("href",e),supportsLogin&&$("#container-login").length&&($("#container-login").append("<ul></ul>"),$("#container-login ul").append("<li><a href='"+geonorgeUrl+"kartdata/oppslagsverk/Brukernavn-og-passord/'>Ny bruker</a></li>"),authenticationData.isAuthenticated?$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignOut+"' class='geonorge-aut' title='Logg ut "+authenticationData.userName+"'> Logg ut</a></li>"):$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignIn+"' class='geonorge-aut'> Logg inn</a></li>"))}),$(window).load(function(){var e={disable_search_threshold:10,search_contains:!0};$(".chosen-select").chosen(e),$("[data-toggle='tooltip']").tooltip({trigger:"hover"}),$("li.has-error[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+30"}),$("li[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()}),$(".ui-tooltip-element[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+25"}),$(".ui-tooltip-element[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()}),document.documentElement.setAttribute("data-useragent",navigator.userAgent)}),angular.module("geonorge",["ui.bootstrap"]),angular.module("geonorge").config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["**"])}]);var searchOptionsArray={dev:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",searchPlaceholder:"Søk etter kartdata",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.dev.geonorge.no",url:"//kartkatalog.dev.geonorge.no/search",api:"//kartkatalog.dev.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},test:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",searchPlaceholder:"Søk etter kartdata",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.test.geonorge.no",url:"//kartkatalog.test.geonorge.no/search",api:"//kartkatalog.test.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},prod:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",searchPlaceholder:"Søk etter kartdata",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.geonorge.no",url:"//kartkatalog.geonorge.no/search",api:"//kartkatalog.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.geonorge.no"}},searchOption=searchOptionsArray.prod;if(""!==applicationEnvironment&&null!==applicationEnvironment)var searchOption=searchOptionsArray[applicationEnvironment];var baseurl_local=searchOption.baseUrl;angular.module("geonorge").service("aggregatedService",["$http","$q",function(e,t){var a=document.getElementById("txtLang");a&&a.value;var o=void 0;return{triggerSearch:function(e){return t(function(t){void 0===o?t():o(e)})},executeMethod:function(e){o=e},performSearch:function(a,o,n,r){function i(e,t){return(containsParameters(searchOption.api)?"&":"?")+"limit=5&facets[1]name=type&facets[1]value="+e+"&text="+t}var l=containsParameters(searchOption.api)?"&":"?",s=encodeURI(searchOption.api+l+"limit=5&facets[1]name=type&facets[1]value=dataset&text="+a),c=e({method:"GET",url:s,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),u=encodeURI(searchOption.api+i("servicelayer",a)),d=e({method:"GET",url:u,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),p=encodeURI(searchOption.api+i("service",a)),g=e({method:"GET",url:p,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),h=encodeURI(searchOption.api+i("dimensionGroup",a)),m=e({method:"GET",url:h,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),v=encodeURI(searchOption.api+i("software",a)),f=e({method:"GET",url:v,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}});return t.all([m,c,g,d,f])}}}]).controller("searchTopController",["$rootScope","$scope","$location","$window","$timeout","aggregatedService","$sce",function(e,t,a,o,n,r,i){function l(){var a=t.selectedSearch,n="";""!==e.searchQuery&&(n=a.queryParameter,n+=e.searchQuery);var r=a.url+n;o.location.href=r}function s(e){if(t.ajaxCallActive=!1,t.autoCompleteResult=[],e.d){var a=[];if(0===e.d.NumberOfHitsTotal)return void(t.autoCompleteResult=[]);a=e.d.Results;for(var o=0;o<a.length;o++){var n={},r=a[o];if(null!=r.data&&0!==r.data.Results.length){n.type=r.Section,n.title=r.SectionName,n.list=[];for(var i=0;i<r.data.Results.length;i++){var l=r.data.Results[i];n.title=c(l.Type),n.url=searchOption.url,n.list.push({externalId:r.SectionName+"_"+r.Section+"_"+i,id:i,typeId:r.Section,title:l.Title,url:l.ShowDetailsUrl})}t.autoCompleteResult.push(n)}}}}function c(e){switch(e){case"dataset":return"Datasett";case"servicelayer":return"Tjenestelag";case"service":return"Tjenester";case"dimensionGroup":return"Datapakker";case"software":return"Applikasjon"}}function u(){v>0&&1==m&&0===--v&&(m=null),1==v&&m>1&&(m--,v=t.autoCompleteResult[m-1].list.length),m>1&v>1&&v--,p()}function d(){null===m?(m=1,v=1):(m==t.autoCompleteResult.length&&t.autoCompleteResult[m-1].list.length>v&&v++,m<t.autoCompleteResult.length&&(t.autoCompleteResult[m-1].list.length>v?v++:(m++,v=1))),p()}function p(){for(var e=0;e<t.autoCompleteResult.length;e++){var a=t.autoCompleteResult[e];if(e==m-1)for(var o=0;o<a.list.length;o++){var n=a.list[o];n.highlight=o==v-1}else for(var r=0;r<a.list.length;r++)a.list[r].highlight=!1}}e.trustHtml=function(e){return i.trustAsHtml(e)},t.dropdownOpen=!1,t.extendedSearchOpen=!1,t.showFakeResults=!1,t.searchString="",e.selectedSearch=searchOption,e.searchQuery=parseLocation(window.location.search).text,t.autoCompleteResult=[],t.autoCompletePartial="/Content/bower_components/kartverket-felleskomponenter/assets/partials/_autoCompleteRow.html",t.focused=!1,t.autocompleteActive=!1,t.ajaxCallActive=!1,t.allowBlur=!0,t.viewport={width:window.innerWidth,height:window.innerHeight},t.breakpoints={xSmall:480,small:768,medium:992,large:1200};var g=function(a,o){a.preventDefault(),a.stopPropagation(),e.selectedSearch=o,t.dropdownOpen=!1,document.getElementById("txtSearch").focus()};t.select=g;t.dropdownKeyDown=function(e,t){var a;switch(e.keyCode){case 13:return void g(e,dropdownOptions[t]);case 38:var o=angular.element(document.getElementById("search-dropdown"));a=0===t?o.children()[dropdownOptions.length-1]:o.children()[t-1];break;case 40:a=t>=dropdownOptions.length-1?angular.element(document.getElementById("search-dropdown")).children()[0]:angular.element(e.target).next()[0];break;default:return}e.target.blur(),a.focus(),e.preventDefault(),e.stopPropagation()},t.buttonDropdownKeyDown=function(e){switch(e.keyCode){case 38:e.target.blur(),angular.element(e.target).next().children()[dropdownOptions.length-1].focus();break;case 40:e.target.blur(),angular.element(e.target).next().children()[0].focus();break;default:return}e.preventDefault(),e.stopPropagation()},t.onSearch=function(t){t&&t.preventDefault(),e.searchQuery.length<3||r.triggerSearch(e.searchQuery).then(l)},t.preventDefault=function(e){switch(e.keyCode){case 13:e.preventDefault();break;case 16:f=!0;break;case 9:t.autoCompleteResult.length>0&&e.preventDefault();break;case 38:case 40:e.preventDefault()}};var h=null;t.autocomplete=function(a){if(!1!==t.focused){if(e.searchQuery.length<3)return t.autoCompleteResult=[],t.autocompleteActive=!1,t.ajaxCallActive=!1,void(m=null);switch(a.keyCode){case 13:null===m?(t.resetAutocomplete(),t.allowBlur=!0,t.onSearch(a)):(t.allowBlur=!1,window.location=t.autoCompleteResult[m-1].list[v-1].url);break;case 16:f=!1;break;case 37:break;case 38:return u(),!1;case 39:break;case 9:f?u():d();break;case 40:return d(),!1;default:return m=null,h&&(n.cancel(h),h=null),void(h=n(function(){t.autocompleteActive=!0,e.searchQuery.length>0&&(t.ajaxCallActive=!0,r.performSearch(e.searchQuery,[],5,0).then(function(e){s({d:{Results:e}})}))},300))}}};var m=null,v=null,f=!1;t.mouseOver=function(e,a,o){t.allowBlur=e,v=o+1,m=a+1,p()},t.mouseOut=function(e){t.allowBlur=e},t.resetAutocomplete=function(){t.focused=!1,t.autocompleteActive=!1,t.ajaxCallActive=!1,t.autoCompleteResult=[]},t.setFocus=function(e){t.focused=!0,angular.element(e.target).on("blur",function(){n(function(){t.allowBlur&&(t.resetAutocomplete(),angular.element(e.target).on("blur",null))},!0)})},angular.element(document).ready(function(){r.triggerSearch(e.searchQuery)})}]);var parseLocation=function(e){var t,a,o=e.substring(1).split("&"),n={};for(a in o)""!==o[a]&&(t=o[a].split("="),n[decodeURIComponent(t[0])]=decodeURIComponent(t[1]));return n},baseurl="http://"+window.location.host;$(document).ready(function(){$(".page-wizard .page-wizard-tab").on("click",function(){$(".page-wizard").toggleClass("open")});var e=$("<li class='jose'><ul></ul></li>");$("<p>te</p>").appendTo($(e).find("ul"))}),function(){var e=angular.module("geonorge"),t=searchOption.geonorgeUrl;e.controller("menuTopController",["$scope","$http",function(e,a){function o(t){localStorage.setItem("menuItems",JSON.stringify(t));var a=new Date;a.setTime(a.getTime()+18e4),Cookies.set("expire","menu",{expires:a}),e.menuItems=t.data}function n(){e.getMenuError=!0}e.getMenuData=function(){if(!Cookies.get("expire")||!localStorage.getItem("menuItems"))return a({method:"GET",url:t+"/api/menu",headers:{"Content-Type":"application/json; charset=utf-8"},data:{}}).then(o,n);response=JSON.parse(localStorage.getItem("menuItems")),e.menuItems=response.data}}])}(),$(window).load(function(){removeBrokenOrderItems(),updateShoppingCart()}),$("document").ready(function(){updateToggleLinks($(".toggle-content")),$(".toggle-content").click(function(){var e=$(this).data("content-toggle");updateToggleLinks($(this)),$("."+e).toggle()})}),$(".link-tabs").ready(function(){$(".link-tabs li a").click(function(e){e.preventDefault(),activateTab($(this).data("tab")),$("#tab-content").css("opacity",".15"),window.location.href=$(this).prop("href")})}),$("document").ready(function(){$("a.help-text-toggle").click(function(e){e.preventDefault();var t=$(this),a=$(this).data("help-text-id");$("#"+a).toggle(),$("#"+a).hasClass("active")?($("#"+a).removeClass("active"),t.removeClass("active")):($("#"+a).addClass("active"),t.addClass("active"))})}),$("document").ready(function(){$("ul.pagination a, ul.breadcrumbs a").each(function(){$(this).closest("li").hasClass("active")||addDefaultLoadingAnimation($(this))})}),$("document").ready(function(){$("body").on("click","a",function(){notCurrentUrl($(this).attr("href"))&&$(this).removeClass("show-loading-animation")})}),$("document").ready(function(){disableLastBreadcrumb()}),$(document).on("focus",".custom-select-list-input",function(){$(this).closest(".custom-select-list").find(".custom-select-list-dropdown-container").addClass("active")}),$(document).on("click",".custom-select-list-input-container",function(){$(this).find(".custom-select-list-input").focus()}),$(document).on("keyup",".custom-select-list",function(){filterDropdownList($(this).find(".custom-select-list-input"),$(this))}),$("document").ready(function(){$(".custom-select-list").length&&$(document).on("click",function(e){var t=!1,a=null;$(".custom-select-list").each(function(o,n){for(var r=e.target;r&&r.parentNode;)(r=r.parentNode)&&r==n&&(t=!0,a=o)}),$(".custom-select-list").each(function(e,t){if(e!==a){$(this).find(".custom-select-list-dropdown-container").removeClass("active");var o=$(this).find(".custom-select-list-input");o.val(""),filterDropdownList(o,$(this))}})})});