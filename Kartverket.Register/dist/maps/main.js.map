{"version":3,"sources":["node_modules/geonorge-shared-partials/src/js/searchOptions.js","node_modules/geonorge-shared-partials/src/js/app.js","node_modules/geonorge-shared-partials/src/js/baseController.js","node_modules/geonorge-shared-partials/src/js/menuTopController.js","node_modules/geonorge-shared-partials/src/js/searchTopController.js"],"names":["kartKatalogenUrl","local","test","prod","geonorgeBaseUrl","searchOptions","text","searchTitle","buttonCss","listCss","queryParameter","localUrl","autoComplete","url","api","shoppingCartUrl","loginUrl","logoutUrl","hosts","epiBaseUrl","imageLogoPath","dev","searchOption","applicationEnvironment","supportsLogin","undefined","supportsCulture","angular","module","app","controller","$scope","$http","langCode","Cookies","get","localizedText","search","en","no","menu","login","logout","cultureSwitchName","cultureSwitchCode","cultureData","cultureSwitchUrl","friendlyUrlNO","friendlyUrlEN","switchCulture","cultureCode","document","cookie","loggedIn","handleSuccess","response","menuItems","data","console","debug","handleError","getMenuError","trustSrc","src","$sce","trustAsResourceUrl","getMenuData","domainUrl","menuService","request","method","headers","Content-Type","accept","crossDomain","then","ENTER","UP","DOWN","SHIFT","TAB","LEFT","RIGHT","service","$q","executeMethod","methodToExecute","triggerSearch","value","reject","performSearch","query","filters","limit","section","getSearchParameters","facetValue","facetParameters","queryParameters","encodeURI","menuService1","request1","menuService2","request2","menuService3","request3","menuService4","request4","all","txtLang","getElementById","lang","$rootScope","$location","$window","$timeout","aggregatedService","fallbackRouting","selectedSearch","param","searchQuery","relativeUrl","location","href","displayAutoCompleteData","ajaxCallActive","autoCompleteResult","d","list","NumberOfHitsTotal","Results","x","length","item","curr","showAllUrl","getUrlParameters","Type","indexOf","y","currResult","title","getType","push","externalId","SectionName","Section","id","typeId","Title","ShowDetailsUrl","type","currentCulture","baseUrl","autoCompleteMoveUp","resultCount","categoryCount","setHighlightedRow","autoCompleteMoveDown","innerItem","highlight","z","trustHtml","html","trustAsHtml","dropdownOpen","extendedSearchOpen","showFakeResults","searchString","parseLocation","window","activePageUrl","host","pathname","showAllText","noResultsText","loadingContentText","loadingSearchResultsText","autoCompletePartial","focused","autocompleteActive","allowBlur","viewport","width","innerWidth","height","innerHeight","breakpoints","xSmall","small","medium","large","select","e","preventDefault","stopPropagation","txt","focus","buttonDropdownKeyDown","dropdown","keyCode","target","blur","element","next","children","dropdownOptions","dropdownKeyDown","toFocus","onSearch","ev","shiftKey","timer","autocomplete","resetAutocomplete","cancel","arrayOfResults","mouseOver","val","category","index","mouseOut","setFocus","on","ready","pair","i","pairs","substring","split","obj","decodeURIComponent"],"mappings":"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","file":"main.js","sourcesContent":["var kartKatalogenUrl = {\r\n    local: \"//kartkatalog.dev.geonorge.no\",\r\n    test: \"//kartkatalog.test.geonorge.no\",\r\n    prod: \"//kartkatalog.geonorge.no\"\r\n};\r\nvar geonorgeBaseUrl = { \r\n    local: \"//localhost:61381\",\r\n    test: \"www.test.geonorge.no\",\r\n    prod: \"www.geonorge.no\"\r\n};\r\nvar searchOptions = {\r\n    local: {\r\n        text: \"Kartkatalogen\",\r\n        searchTitle: \"Kartkatalogen\",\r\n        buttonCss: \"edgesKartkatalogen\",\r\n        listCss: \"left-edge-kartkatalogen\",    \r\n        queryParameter: \"?text=\",\r\n        localUrl: false,\r\n        autoComplete: true,\r\n        url: kartKatalogenUrl.local + \"/search\",\r\n        api: kartKatalogenUrl.local + \"/api/search\",\r\n        shoppingCartUrl: kartKatalogenUrl.local + \"/nedlasting\",\r\n        loginUrl: kartKatalogenUrl.local + \"/AuthServices/SignIn?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.local+\"%2F\",\r\n        logoutUrl: kartKatalogenUrl.local + \"/AuthServices/SignOut?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.local+\"%2F\",\r\n        hosts: \"localhost,geonorge.epidemo.no,geonorge.local,kartkatalog.dev.geonorge.no\",\r\n        epiBaseUrl: geonorgeBaseUrl.local,\r\n        imageLogoPath: \"/dist/images/geonorge_logo_350px_dev.svg\"\r\n    },\r\n    dev: {\r\n        text: \"Kartkatalogen\",\r\n        searchTitle: \"Kartkatalogen\",\r\n        buttonCss: \"edgesKartkatalogen\",\r\n        listCss: \"left-edge-kartkatalogen\",    \r\n        queryParameter: \"?text=\",\r\n        localUrl: false,\r\n        autoComplete: true,\r\n        url: kartKatalogenUrl.local + \"/search\",\r\n        api: kartKatalogenUrl.local + \"/api/search\",\r\n        shoppingCartUrl: kartKatalogenUrl.local + \"/nedlasting\",\r\n        loginUrl: kartKatalogenUrl.local + \"/AuthServices/SignIn?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.local+\"%2F\",\r\n        logoutUrl: kartKatalogenUrl.local + \"/AuthServices/SignOut?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.local+\"%2F\",\r\n        hosts: \"localhost,geonorge.epidemo.no,geonorge.local,kartkatalog.dev.geonorge.no\",\r\n        epiBaseUrl: geonorgeBaseUrl.local,\r\n        imageLogoPath: \"/dist/images/geonorge_logo_350px_dev.svg\"\r\n    },\r\n    test: {\r\n        text: \"Kartkatalogen\",\r\n        searchTitle: \"Kartkatalogen\",\r\n        buttonCss: \"edgesKartkatalogen\",\r\n        listCss: \"left-edge-kartkatalogen\",    \r\n        queryParameter: \"?text=\",\r\n        localUrl: false,\r\n        autoComplete: true,\r\n        url: kartKatalogenUrl.test + \"/search\",\r\n        api: kartKatalogenUrl.test + \"/api/search\",\r\n        shoppingCartUrl: kartKatalogenUrl.test + \"/nedlasting\",\r\n        loginUrl: kartKatalogenUrl.test + \"/AuthServices/SignIn?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.test+\"%2F\",\r\n        logoutUrl: kartKatalogenUrl.test + \"/AuthServices/SignOut?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.test+\"%2F\",\r\n        hosts: \"test.geonorge.no,kartkatalog.test.geonorge.no,register.test.geonorge.no,objektkatalog.test.geonorge.no,editor.test.geonorge.no,produktark.test.geonorge.no,validering.test.geonorge.no,159.162.102.155,kartkatalog.dev.geonorge.no,register.dev.geonorge.no,objektkatalog.dev.geonorge.no,editor.dev.geonorge.no,produktark.dev.geonorge.no,validering.dev.geonorge.no,159.162.102.155,kartkatalog.dev.geonorge.no,register.dev.geonorge.no,objektkatalog.dev.geonorge.no,editor.dev.geonorge.no,produktark.dev.geonorge.no,validering.dev.geonorge.no,159.162.102.155\",\r\n        epiBaseUrl: \"//\" + geonorgeBaseUrl.test,\r\n        imageLogoPath: \"/dist/images/geonorge_logo_350px_test.svg\"\r\n    },\r\n    prod: {\r\n        text: \"Kartkatalogen\",\r\n        searchTitle: \"Kartkatalogen\",\r\n        buttonCss: \"edgesKartkatalogen\",\r\n        listCss: \"left-edge-kartkatalogen\",    \r\n        queryParameter: \"?text=\",\r\n        localUrl: false,\r\n        autoComplete: true,\r\n        url: kartKatalogenUrl.prod + \"/search\",\r\n        api: kartKatalogenUrl.prod + \"/api/search\",\r\n        shoppingCartUrl: kartKatalogenUrl.prod + \"/nedlasting\",\r\n        loginUrl: kartKatalogenUrl.prod + \"/AuthServices/SignIn?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.prod+\"%2F\",\r\n        logoutUrl: kartKatalogenUrl.prod + \"/AuthServices/SignOut?ReturnUrl=http%3A%2F%2F\"+geonorgeBaseUrl.prod+\"%2F\",\r\n        hosts: \"geonorge.no,kartkatalog.geonorge.no,register.geonorge.no,objektkatalog.geonorge.no,editor.geonorge.no,produktark.geonorge.no,validering.geonorge.no,159.162.102.155\",\r\n        epiBaseUrl: \"//\" + geonorgeBaseUrl.prod,\r\n        imageLogoPath: \"/dist/images/geonorge_logo_350px.svg\"\r\n    }\r\n};\r\n\r\nvar searchOption = searchOptions.prod;\r\nvar applicationEnvironment = applicationEnvironment || \"\";\r\nif (applicationEnvironment !== \"\") {\r\n\tvar searchOption = searchOptions[applicationEnvironment];\r\n}\r\n\r\nsearchOption.supportsLogin = (searchOption.supportsLogin !== undefined) ? searchOption.supportsLogin : true;\r\nsearchOption.supportsCulture = (searchOption.supportsCulture !== undefined) ? searchOption.supportsCulture : true;\r\n","angular.module('geonorge-header', ['ui.bootstrap']);","(function() {\r\n    var app = angular.module(\"geonorge-header\");\r\n\r\n    app.controller(\"baseController\", [\r\n        \"$scope\", \"$http\",\r\n        function($scope, $http) {       \r\n            // * Language *     \r\n            if (typeof(Cookies) !== 'undefined'){\r\n                $scope.langCode = Cookies.get(\"_culture\");                \r\n            } else {\r\n                $scope.langCode = \"no\";\r\n            }\r\n            $scope.localizedText = {\r\n                search: {\r\n                    en: \"Search\",\r\n                    no: \"Søk\"\r\n                },\r\n                menu: {\r\n                    en: \"Menu\",\r\n                    no: \"Meny\"\r\n                },\r\n                login: {\r\n                    en: \"Login\",\r\n                    no: \"Logg inn\"\r\n                },\r\n                logout: {\r\n                    en: \"Log out\",\r\n                    no: \"Logg ut\"\r\n                }\r\n            }            \r\n            switch ($scope.langCode) {\r\n                case \"en\":\r\n                    $scope.cultureSwitchName = \"Norsk\";\r\n                    $scope.cultureSwitchCode = \"no\";\r\n                    if (cultureData)\r\n                        $scope.cultureSwitchUrl = cultureData.friendlyUrlNO;\r\n                    break;\r\n                default:\r\n                    $scope.cultureSwitchName = \"English\";\r\n                    $scope.cultureSwitchCode = \"en\";\r\n                    if (cultureData)\r\n                        $scope.cultureSwitchUrl = cultureData.friendlyUrlEN;\r\n            }\r\n            $scope.switchCulture = function(cultureCode) {\r\n                document.cookie = \"_culture=\" + cultureCode + \"; path=/;domain=.geonorge.no\";\r\n            }\r\n\r\n            // * Is logged in *\r\n            if (typeof(Cookies) !== 'undefined')\r\n                $scope.loggedIn = Cookies.get(\"_loggedIn\");\r\n            if (searchOption.loggedIn !== undefined)\r\n                $scope.loggedIn = searchOption.loggedIn;\r\n\r\n            // * Logo *\r\n            $scope.imageLogoPath = \"/dist/images/geonorge_logo_350px.svg\";\r\n            if (searchOption.imageLogoPath !== undefined)\r\n                $scope.imageLogoPath = searchOption.imageLogoPath;\r\n\r\n            // * Logo url *\r\n            $scope.epiBaseUrl = \"//www.geonorge.no\";\r\n            if (searchOption.epiBaseUrl !== undefined)\r\n                $scope.epiBaseUrl = searchOption.epiBaseUrl;\r\n\r\n            // * Shopping cart url *\r\n            $scope.shoppingCartUrl = \"//kartkatalog.geonorge.no/nedlasting\";\r\n            if (searchOption.shoppingCartUrl !== undefined)\r\n                $scope.shoppingCartUrl = searchOption.shoppingCartUrl;\r\n        }\r\n    ]);\r\n}());","(function() {\r\n    var app = angular.module(\"geonorge-header\");\r\n\r\n    app.controller(\"menuTopController\", [\r\n        \"$scope\", \"$http\",\r\n        function($scope, $http) {\r\n            $scope.trustSrc = function (src) {\r\n                return $sce.trustAsResourceUrl(src);\r\n            }\r\n\r\n            function handleSuccess(response) {\r\n                var menuItems = response.data;\r\n                $scope.menuItems = menuItems;\r\n                console.debug(\"menuItems\", menuItems);\r\n            }\r\n\r\n            function handleError(response) {\r\n                $scope.getMenuError = true;\r\n                console.debug(\"Error while getting menuItems\", response);\r\n            }\r\n\r\n            $scope.getMenuData = function getMenuData() {\r\n                var domainUrl = \"\";\r\n                if (searchOption.epiBaseUrl !== undefined)\r\n                    domainUrl = searchOption.epiBaseUrl;\r\n                var menuService = domainUrl + \"/api/menu\" + \"?omitLinks=1\";\r\n                var request = $http({\r\n                    method: \"GET\",\r\n                    url: menuService,\r\n                    headers: {\r\n                        'Content-Type': \"application/json; charset=utf-8\",\r\n                        'accept': \"*/*\"\r\n                    },\r\n                    data: {},\r\n                    crossDomain: true\r\n                });\r\n\r\n                return request.then(handleSuccess, handleError);\r\n            };\r\n\r\n            // * Login url *\r\n            $scope.loginUrl = '//kartkatalog.geonorge.no/AuthServices/SignIn?ReturnUrl=http%3A%2F%2Fwww.geonorge.no%2F';\r\n            if (searchOption.loginUrl !== undefined)\r\n                $scope.loginUrl = searchOption.loginUrl;\r\n\r\n            // * Log out url *\r\n            $scope.logoutUrl = '//kartkatalog.geonorge.no/AuthServices/SignOut?ReturnUrl=http%3A%2F%2Fwww.geonorge.no%2F';\r\n            if (searchOption.logoutUrl !== undefined)\r\n                $scope.logoutUrl = searchOption.logoutUrl;\r\n        }]);\r\n}());","(function () {\r\n    const ENTER = 13;\r\n    const UP = 38;\r\n    const DOWN = 40;\r\n    const SHIFT = 16;\r\n    const TAB = 9;\r\n    const LEFT = 37;\r\n    const RIGHT = 39;\r\n\r\n    var app = angular.module(\"geonorge-header\");\r\n\r\n    app.service('aggregatedService', ['$http', '$q', function ($http, $q) {\r\n        var txtLang = document.getElementById('txtLang');\r\n        var lang = '';\r\n        if (txtLang) lang = txtLang.value;\r\n\r\n        var methodToExecute = undefined;\r\n\r\n        return ({\r\n            triggerSearch: triggerSearch,\r\n            executeMethod: executeMethod,\r\n            performSearch: performSearch\r\n        });\r\n\r\n\r\n        function executeMethod(method) {\r\n            methodToExecute = method;\r\n        }\r\n\r\n        function triggerSearch(value) {\r\n            return $q(function (reject) {\r\n                if (methodToExecute == undefined) {\r\n                    reject();\r\n                } else {\r\n                    methodToExecute(value);\r\n                }\r\n            });\r\n        }\r\n\r\n        function performSearch(query, filters, limit, section) {\r\n\r\n            function getSearchParameters(facetValue, query) {\r\n                var facetParameters = 'facets[1]name=type&facets[1]value=' + facetValue;\r\n                var queryParameters = 'text=' + query;\r\n                return '?limit=5&' + facetParameters + '&' + queryParameters;\r\n            }\r\n\r\n            var menuService = encodeURI(searchOption.api + getSearchParameters('dataset', query));\r\n            var request = $http({\r\n                method: 'GET',\r\n                url: menuService,\r\n                headers: {\r\n                    'Content-Type': 'application/json; charset=utf-8',\r\n                    'accept': '*/*'\r\n                },\r\n                data: {}\r\n            });\r\n\r\n            var menuService1 = encodeURI(searchOption.api + getSearchParameters('servicelayer', query));\r\n            var request1 = $http({\r\n                method: 'GET',\r\n                url: menuService1,\r\n                headers: {\r\n                    'Content-Type': 'application/json; charset=utf-8',\r\n                    'accept': '*/*'\r\n                },\r\n                data: {}\r\n            });\r\n\r\n            var menuService2 = encodeURI(searchOption.api + getSearchParameters('service', query));\r\n            var request2 = $http({\r\n                method: 'GET',\r\n                url: menuService2,\r\n                headers: {\r\n                    'Content-Type': 'application/json; charset=utf-8',\r\n                    'accept': '*/*'\r\n                },\r\n                data: {}\r\n            });\r\n\r\n            var menuService3 = encodeURI(searchOption.api + getSearchParameters('dimensionGroup', query));\r\n            var request3 = $http({\r\n                method: 'GET',\r\n                url: menuService3,\r\n                headers: {\r\n                    'Content-Type': 'application/json; charset=utf-8',\r\n                    'accept': '*/*'\r\n                },\r\n                data: {}\r\n            });\r\n\r\n            var menuService4 = encodeURI(searchOption.api + getSearchParameters('software', query));\r\n            var request4 = $http({\r\n                method: 'GET',\r\n                url: menuService4,\r\n                headers: {\r\n                    'Content-Type': 'application/json; charset=utf-8',\r\n                    'accept': '*/*'\r\n                },\r\n                data: {}\r\n            });\r\n\r\n\r\n            return $q.all([request3, request, request2, request1, request4]);\r\n        }\r\n\r\n    }]).controller('searchTopController', [\r\n        '$rootScope', '$scope', '$location', '$window', '$timeout', 'aggregatedService', '$sce',\r\n        function ($rootScope, $scope, $location, $window, $timeout, aggregatedService, $sce) {\r\n            $scope.trustSrc = function (src) {\r\n                return $sce.trustAsResourceUrl(src);\r\n            }\r\n\r\n            $rootScope.trustHtml = function (html) {\r\n                return $sce.trustAsHtml(html);\r\n            };\r\n\r\n            $scope.dropdownOpen = false;\r\n            $scope.extendedSearchOpen = false;\r\n            $scope.showFakeResults = false;\r\n            $scope.searchString = \"\";\r\n            $rootScope.selectedSearch = searchOption;\r\n            $rootScope.searchQuery = parseLocation(window.location.search).text;\r\n            $rootScope.activePageUrl = \"//\" + window.location.host + window.location.pathname + window.location.search;\r\n\r\n            // Values based on selected language\r\n            if (cultureData.currentCulture === undefined || cultureData.currentCulture === '' || cultureData.currentCulture == 'no') {\r\n                $rootScope.showAllText = \"Vis alle treff...\";\r\n                $rootScope.noResultsText = \"Søket gir ingen treff\";\r\n                $rootScope.loadingContentText = \"Henter innhold\";\r\n                $rootScope.loadingSearchResultsText = \"Henter søkeresultater\";\r\n            } else if (cultureData.currentCulture == 'en') {\r\n                $rootScope.showAllText = \"Show all results...\";\r\n                $rootScope.noResultsText = \"Your search did not return any data\";\r\n                $rootScope.loadingContentText = \"Loading content\";\r\n                $rootScope.loadingSearchResultsText = \"Loading search results\";\r\n            }\r\n\r\n            $scope.autoCompleteResult = [];\r\n\r\n            $scope.autoCompletePartial = '/dist/partials/_autoCompleteRow.html';\r\n            $scope.focused = false;\r\n            $scope.autocompleteActive = false;\r\n            $scope.ajaxCallActive = false;\r\n            $scope.allowBlur = true;\r\n            $scope.viewport = {\r\n                width: window.innerWidth,\r\n                height: window.innerHeight\r\n            };\r\n            $scope.breakpoints = {\r\n                xSmall: 480,\r\n                small: 768,\r\n                medium: 992,\r\n                large: 1200\r\n            };\r\n\r\n            var select = function (e, search) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                $rootScope.selectedSearch = search;\r\n                $scope.dropdownOpen = false;\r\n                var txt = document.getElementById('txtSearch');\r\n                txt.focus();\r\n            };\r\n\r\n            $scope.select = select;\r\n\r\n            var buttonDropdownKeyDown = function (e) {\r\n                var dropdown;\r\n                switch (e.keyCode) {\r\n                    case UP:\r\n                        e.target.blur();\r\n                        dropdown = angular.element(e.target).next();\r\n                        dropdown.children()[dropdownOptions.length - 1].focus();\r\n                        break;\r\n                    case DOWN:\r\n                        e.target.blur();\r\n                        dropdown = angular.element(e.target).next();\r\n                        dropdown.children()[0].focus();\r\n                        break;\r\n                    default:\r\n                        return;\r\n                }\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            };\r\n\r\n            var dropdownKeyDown = function (e, id) {\r\n                var toFocus;\r\n                switch (e.keyCode) {\r\n                    case ENTER:\r\n                        select(e, dropdownOptions[id]);\r\n                        return;\r\n                    case UP:\r\n                        var dropdown = angular.element(document.getElementById(\"search-dropdown\"));\r\n                        if (id === 0) { //Wrap-around\r\n                            toFocus = dropdown.children()[dropdownOptions.length - 1];\r\n                        } else {\r\n                            toFocus = dropdown.children()[id - 1];\r\n                        }\r\n                        break;\r\n                    case DOWN:\r\n                        if (id >= dropdownOptions.length - 1) { //Wrap-around\r\n                            toFocus = angular.element(document.getElementById(\"search-dropdown\")).children()[0];\r\n                        } else {\r\n                            toFocus = angular.element(e.target).next()[0];\r\n                        }\r\n                        break;\r\n                    default:\r\n                        return; //Dont stop propagation/default\r\n                }\r\n                e.target.blur();\r\n                toFocus.focus();\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            };\r\n\r\n            $scope.dropdownKeyDown = dropdownKeyDown;\r\n            $scope.buttonDropdownKeyDown = buttonDropdownKeyDown;\r\n\r\n            $scope.onSearch = function (ev) {\r\n                if (ev) ev.preventDefault();\r\n                if (!$rootScope.searchQuery || $rootScope.searchQuery.length < 3) return;\r\n\r\n                //The service tries to trigger the connected search method - if not, the fallback method is used\r\n                var src = aggregatedService.triggerSearch($rootScope.searchQuery);\r\n                //Specify a fallback in case aggregatedService doesn't have a method for search implemented\r\n                src.then(fallbackRouting);\r\n            };\r\n\r\n            function fallbackRouting() {\r\n                var search = $scope.selectedSearch;\r\n                var param = '';\r\n                if ($rootScope.searchQuery !== '') {\r\n                    param = search.queryParameter;\r\n                    param += $rootScope.searchQuery;\r\n                }\r\n\r\n                var relativeUrl = search.url + param;\r\n                $window.location.href = relativeUrl;\r\n            }\r\n\r\n            $scope.preventDefault = function (ev) {\r\n\r\n                switch (ev.keyCode) {\r\n                    case ENTER:\r\n                        ev.preventDefault();\r\n                        break;\r\n                    case SHIFT:\r\n                        shiftKey = true;\r\n                        break;\r\n                    case TAB:\r\n                        if ($scope.autoCompleteResult.length > 0) {\r\n                            ev.preventDefault();\r\n                        }\r\n                        break;\r\n                    case UP:\r\n                    case DOWN:\r\n                        ev.preventDefault();\r\n                        break;\r\n                }\r\n            };\r\n\r\n            var timer = null;\r\n            $scope.autocomplete = function (ev) {\r\n                if ($scope.focused === false) return;\r\n\r\n                if (!$rootScope.searchQuery || $rootScope.searchQuery.length < 3) {\r\n                    $scope.autoCompleteResult = [];\r\n                    $scope.autocompleteActive = false;\r\n                    $scope.ajaxCallActive = false;\r\n                    categoryCount = null;\r\n                    return;\r\n                }\r\n\r\n                switch (ev.keyCode) {\r\n                    case ENTER:\r\n                        if (categoryCount === null) {\r\n                            $scope.resetAutocomplete();\r\n                            $scope.allowBlur = true;\r\n                            $scope.onSearch(ev);\r\n                        } else {\r\n                            $scope.allowBlur = false;\r\n                            window.location = $scope.autoCompleteResult[categoryCount - 1].list[resultCount - 1].url;\r\n                        }\r\n                        break;\r\n                    case SHIFT:\r\n                        shiftKey = false;\r\n                        break;\r\n                    case LEFT:\r\n                        break;\r\n                    case UP:\r\n                        autoCompleteMoveUp();\r\n                        return false;\r\n                    case RIGHT:\r\n                        break;\r\n                    case TAB:\r\n                        if (!shiftKey) {\r\n                            autoCompleteMoveDown();\r\n                        } else {\r\n                            autoCompleteMoveUp();\r\n                        }\r\n                        break;\r\n                    case DOWN:\r\n                        autoCompleteMoveDown();\r\n                        return false;\r\n                    default:\r\n                        categoryCount = null;\r\n                        if (timer) {\r\n                            $timeout.cancel(timer);\r\n                            timer = null;\r\n                            console.debug('cancel timeout');\r\n                        }\r\n                        timer = $timeout(function () {\r\n                            $scope.autocompleteActive = true;\r\n                            console.debug('calling WS');\r\n                            if ($rootScope.searchQuery.length > 0) {\r\n                                $scope.ajaxCallActive = true;\r\n\r\n                                aggregatedService.performSearch($rootScope.searchQuery, [], 5, 0).then(function (arrayOfResults) {\r\n                                    console.debug(arrayOfResults);\r\n\r\n                                    var response = {\r\n                                        d: {\r\n                                            Results: arrayOfResults\r\n                                        }\r\n                                    };\r\n\r\n                                    displayAutoCompleteData(response);\r\n                                });\r\n\r\n                            }\r\n                        }, 300);\r\n                        return;\r\n                }\r\n            };\r\n\r\n            function displayAutoCompleteData(response) {\r\n                $scope.ajaxCallActive = false;\r\n                $scope.autoCompleteResult = [];\r\n                if (response.d) {\r\n                    var list = [];\r\n\r\n                    if (response.d.NumberOfHitsTotal === 0) {\r\n                        $scope.autoCompleteResult = [];\r\n                        return;\r\n                    }\r\n\r\n                    list = response.d.Results;\r\n\r\n                    for (var x = 0; x < list.length; x++) {\r\n                        var item = {};\r\n                        var curr = list[x];\r\n                        if (curr.data == null || curr.data.Results.length === 0) continue;\r\n                        var showAllUrl = getUrlParameters(curr.data.Results[0].Type);\r\n                        var searchQuery = showAllUrl.length && showAllUrl.indexOf(\"?\") > -1 ? '&text=' + $rootScope.searchQuery : '?text=' + $rootScope.searchQuery;\r\n\r\n                        item.showAllUrl = showAllUrl + searchQuery;\r\n                        item.list = [];\r\n\r\n                        for (var y = 0; y < curr.data.Results.length; y++) {\r\n                            var currResult = curr.data.Results[y];\r\n\r\n                            item.title = getType(currResult.Type);\r\n\r\n                            item.list.push({\r\n                                externalId: curr.SectionName + '_' + curr.Section + '_' + y,\r\n                                id: y,\r\n                                typeId: curr.Section,\r\n                                title: currResult.Title,\r\n                                url: currResult.ShowDetailsUrl\r\n                            });\r\n                        }\r\n                        $scope.autoCompleteResult.push(item);\r\n                        console.debug(item);\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n            function getType(type) {\r\n                if (cultureData.currentCulture === undefined || cultureData.currentCulture == '' || cultureData.currentCulture == 'no') {\r\n                    switch (type) {\r\n                        case \"dataset\":\r\n                            return \"Datasett\";\r\n                        case \"servicelayer\":\r\n                            return \"Tjenestelag\";\r\n                        case \"service\":\r\n                            return \"Tjenester\";\r\n                        case \"dimensionGroup\":\r\n                            return \"Datapakker\";\r\n                        case \"software\":\r\n                            return \"Applikasjon\";\r\n                        default:\r\n                    }\r\n                } else if (cultureData.currentCulture == 'en') {\r\n                    switch (type) {\r\n                        case \"dataset\":\r\n                            return \"Dataset\";\r\n                        case \"servicelayer\":\r\n                            return \"Service layer\";\r\n                        case \"service\":\r\n                            return \"Service\";\r\n                        case \"dimensionGroup\":\r\n                            return \"Data package\";\r\n                        case \"software\":\r\n                            return \"Application\";\r\n                        default:\r\n                    }\r\n                }\r\n            }\r\n\r\n            function getUrlParameters(type) {\r\n                var baseUrl = searchOption.url;\r\n                switch (type) {\r\n                    case \"dataset\":\r\n                        return baseUrl + \"?Facets%5B0%5D.name=type&Facets%5B0%5D.value=dataset\";\r\n                    case \"servicelayer\":\r\n                        return baseUrl + \"?Facets%5B0%5D.name=type&Facets%5B0%5D.value=service&Facets%5B1%5D.name=type&Facets%5B1%5D.value=servicelayer\";\r\n                    case \"service\":\r\n                        return baseUrl + \"?Facets%5B0%5D.name=type&Facets%5B0%5D.value=service&Facets%5B1%5D.name=type&Facets%5B1%5D.value=servicelayer\";\r\n                    case \"dimensionGroup\":\r\n                        return baseUrl;\r\n                    case \"software\":\r\n                        return baseUrl + \"?Facets%5B0%5D.name=type&Facets%5B0%5D.value=software\";\r\n                    default:\r\n                }\r\n            }\r\n\r\n            var categoryCount = null;\r\n            var resultCount = null;\r\n            var shiftKey = false;\r\n\r\n            function autoCompleteMoveUp() {\r\n\r\n                if (resultCount > 0 && categoryCount == 1) {\r\n                    resultCount--;\r\n                    if (resultCount === 0) categoryCount = null;\r\n                }\r\n\r\n                if (resultCount == 1 && categoryCount > 1) {\r\n                    categoryCount--;\r\n                    resultCount = $scope.autoCompleteResult[categoryCount - 1].list.length;\r\n                }\r\n\r\n\r\n\r\n                if (categoryCount > 1 & resultCount > 1) {\r\n                    resultCount--;\r\n                }\r\n\r\n                setHighlightedRow();\r\n            }\r\n\r\n            function autoCompleteMoveDown() {\r\n                if (categoryCount === null) {\r\n                    categoryCount = 1;\r\n                    resultCount = 1;\r\n                } else {\r\n                    if (categoryCount == $scope.autoCompleteResult.length) {\r\n                        if ($scope.autoCompleteResult[categoryCount - 1].list.length > resultCount) {\r\n                            resultCount++;\r\n                        }\r\n                    }\r\n                    if (categoryCount < $scope.autoCompleteResult.length) {\r\n                        if ($scope.autoCompleteResult[categoryCount - 1].list.length > resultCount) {\r\n                            resultCount++;\r\n                        } else {\r\n                            categoryCount++;\r\n                            resultCount = 1;\r\n                        }\r\n                    }\r\n                }\r\n                setHighlightedRow();\r\n\r\n            }\r\n\r\n            function setHighlightedRow() {\r\n                for (var x = 0; x < $scope.autoCompleteResult.length; x++) {\r\n                    var curr = $scope.autoCompleteResult[x];\r\n                    if (x == categoryCount - 1) {\r\n                        for (var y = 0; y < curr.list.length; y++) {\r\n                            var innerItem = curr.list[y];\r\n                            if (y == resultCount - 1) {\r\n                                innerItem.highlight = true;\r\n                            } else {\r\n                                innerItem.highlight = false;\r\n                            }\r\n                        }\r\n\r\n                    } else {\r\n                        for (var z = 0; z < curr.list.length; z++) {\r\n\r\n                            curr.list[z].highlight = false;\r\n                        }\r\n                    }\r\n                }\r\n                console.debug('categoryCount ' + categoryCount);\r\n                console.debug('resultCount ' + resultCount);\r\n            }\r\n\r\n            $scope.mouseOver = function (val, category, index) {\r\n                console.debug(category);\r\n                console.debug(index);\r\n                $scope.allowBlur = val;\r\n                resultCount = index + 1;\r\n                categoryCount = category + 1;\r\n                setHighlightedRow();\r\n            };\r\n            $scope.mouseOut = function (val) {\r\n                $scope.allowBlur = val;\r\n            };\r\n\r\n            $scope.resetAutocomplete = function () {\r\n                $scope.focused = false;\r\n                $scope.autocompleteActive = false;\r\n                $scope.ajaxCallActive = false;\r\n                $scope.autoCompleteResult = [];\r\n            };\r\n\r\n            $scope.setFocus = function (ev) {\r\n                $scope.focused = true;\r\n                angular.element(ev.target).on('blur', function () {\r\n                    $timeout(function () {\r\n                        if ($scope.allowBlur) {\r\n                            $scope.resetAutocomplete();\r\n                            console.debug($scope.focused);\r\n                            angular.element(ev.target).on('blur', null);\r\n                        }\r\n                    }, true);\r\n                });\r\n            };\r\n            angular.element(document).ready(function () {\r\n                aggregatedService.triggerSearch($rootScope.searchQuery);\r\n            });\r\n        }\r\n    ]);\r\n}());\r\n\r\nvar parseLocation = function (location) {\r\n    var pairs = location.substring(1).split(\"&\");\r\n    var obj = {};\r\n    var pair;\r\n    var i;\r\n\r\n    for (i in pairs) {\r\n        if (pairs[i] === \"\") continue;\r\n\r\n        pair = pairs[i].split(\"=\");\r\n        obj[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\r\n    }\r\n\r\n    return obj;\r\n};"],"sourceRoot":"/source/"}